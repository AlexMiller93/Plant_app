<script type="text/javascript">
    $('.like-btn').click(function(){
        var post_id = $(this).data("post-id");

        $.ajax({
            type: "POST",
            url: "{% url 'like_post' %}",
            data: {
                'post_id': post_id,
                'csrfmiddlewaretoken': '{{ csrf_token }}'
            },
            dataType: "json",
            success: function(data) {
                var icon = document.getElementsByClassName('heart-icon');

                if (data.liked){
                    $(icon).addClass('liked');
                    console.log('User liked');
                    $('.like-count').show().html(data.total_likes);
                }

                else if (data.total_likes==0 && !data.liked){
                    $(icon).addClass('non_liked');
                    console.log('No likes');
                    $('.like-count').hide();
                }

//             TODO: when post hasn't any like and user liked it, class doesn't change -> color: lightgrey
                else {
                    if ($(icon).hasClass('liked')){
                        $(icon).removeClass('liked');
                    }
                    if ($(icon).hasClass('non_liked')){
                        $(icon).removeClass('non_liked');
                    }
                    $('.like-count').show().html(data.total_likes);
                    console.log('Someone liked');
                }

            }
        });

    });

</script>


