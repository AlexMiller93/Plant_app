{% extends 'base.html' %}

{% block title %}Profile Page{% endblock title %}

{% block content %}

<h3 style="text-align:center;">
    {{ profile.user.username | capfirst }} profile page</h3>
<div class="container">
    <a href="{% url 'home' %}">Home</a>
</div>
<br>
<article class="container card border-success mb-3 col-10 col-lg-6">

    <!-- If -->

    <div class="col-2 p-2 m-2 col-lg-1">
        <img src="{{ profile.avatar.url }}" 
        class="rounded-circle article-img" 
        height="60px" width="60px">
    </div>
    <div class="col-10 px-2 col-lg-11">

        <!-- Follower System -->

        <strong>Followers:</strong><br>
        {% if profile.follows.all %}
            {% for following in profile.follows.all %}
                <a href="{% url 'user_profile' following.user.id %}">
                    @{{ following | lower }}</a><br>
            {% endfor %}
        {% else %}
            {% if request.user == profile.user %}
                <p>Oops! You haven't followed anyone. Just click a button and follow somebody!!!</p>
            {% else %}
                <p>Oops! .. {{ profile.user.username }}'s profile hasn't followed by anybody.</p>
            {% endif %}
        {% endif %}<br>

        <strong>Followed by:</strong><br>
        {% if profile.followed_by.all %}
            {% for following in profile.followed_by.all %}
                <a href="{% url 'user_profile' following.user.id %}">
                @{{ following | lower }}</a><br>
            {% endfor %}
        {% else %}
            {% if request.user == profile.user %}
                <p>Oops! You haven't followed by somebody. Write something cool!!</p>
            {% else %}
                <p>Oops! .. {{ profile.user.username }} don't follow anybody.</p>
            {% endif %}
        {% endif %}<br>
        
        <!-- Follow system -->
        <form action="" method="post">
            {% csrf_token %}
            {% if profile in user.profile.follows.all %}
                <button class="btn btn-outline-danger" 
                    name="follow" value="Unfollow" type="submit">
                        Unfollow @{{ profile.user.username | lower }}
                </button>
            {% else %}
                <button class="btn btn-outline-success" 
                    name="follow" value="Follow" type="submit">
                        Follow @{{ profile.user.username | lower }}
                </button>
            {% endif %}
        </form><br>

        <!-- User attributes-->
        <strong>User settings</strong>
        <p>Username: {{ profile.user.username }}</p>
        <p>First name: {{ profile.user.first_name }}</p>
        <p>Last name: {{ profile.user.last_name }}</p>
        <p>Email: {{ profile.user.email }}</p>

        <!-- Profile attributes-->
        <strong>Profile settings</strong>
        <p>Bio: {{ profile.bio }}</p>
        <p>Location: {{ profile.location }}</p>
        <p>Birth_date: {{ profile.birth_date }}</p>
        <br>
        {% if request.user == profile.user %}
            <a href="{% url 'update_profile' %}">Edit Profile</a>
        {% endif %}
        <a href="{% url 'user_posts' profile.pk %}">Show Feed</a>
    </div>

</article>

{% endblock content %}

